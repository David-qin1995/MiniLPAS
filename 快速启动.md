# 快速启动指南

## 📦 编译步骤

### 1. 编译后端

```powershell
cd D:\code\MiniLPAS\web-backend

# 清除之前的JAVA_HOME（如果有错误的设置）
Remove-Item Env:\JAVA_HOME -ErrorAction SilentlyContinue

# 编译（Gradle会自动下载Java 21）
.\gradlew.bat clean build bootJar --no-daemon
```

**编译产物**: `web-backend\build\libs\minilpa-backend.jar`

### 2. 编译代理服务

```powershell
cd D:\code\MiniLPAS\local-agent

# 编译
.\gradlew.bat clean build --no-daemon
```

**编译产物**: `local-agent\build\libs\minilpa-agent.jar`

### 3. 构建前端（可选，开发模式不需要）

```powershell
cd D:\code\MiniLPAS\web-frontend

# 如果还没安装依赖
npm install

# 构建生产版本
npm run build
```

## 🚀 运行服务

### 方式1：分别启动（推荐，便于查看日志）

#### 终端1 - 后端服务

```powershell
cd D:\code\MiniLPAS\web-backend
.\gradlew.bat bootRun
```

或者：

```powershell
cd D:\code\MiniLPAS\web-backend
java -jar build\libs\minilpa-backend.jar
```

#### 终端2 - 代理服务

```powershell
cd D:\code\MiniLPAS\local-agent
.\gradlew.bat run
```

或者：

```powershell
cd D:\code\MiniLPAS\local-agent
java -jar build\libs\minilpa-agent.jar
```

#### 终端3 - 前端服务

```powershell
cd D:\code\MiniLPAS\web-frontend
npm run dev
```

### 方式2：使用启动脚本

```powershell
cd D:\code\MiniLPAS
.\本地启动.ps1
```

这会自动在新窗口中启动所有服务。

## ✅ 验证运行

### 检查服务状态

1. **后端API**: 
   - 浏览器访问: http://localhost:8080/api/devices/status
   - 或 PowerShell: `Invoke-RestMethod http://localhost:8080/api/devices/status`

2. **前端界面**:
   - 浏览器访问: http://localhost:3000

3. **连接状态**:
   - 前端页面应显示"已连接"（如果代理服务正常运行）

## 🔧 常见问题

### 问题1: Java版本错误

**解决方案**:
- 清除JAVA_HOME: `Remove-Item Env:\JAVA_HOME -ErrorAction SilentlyContinue`
- Gradle会自动下载Java 21（如果配置了toolchain）

### 问题2: 端口被占用

**检查端口**:
```powershell
# 检查8080端口
Get-NetTCPConnection -LocalPort 8080

# 检查3000端口
Get-NetTCPConnection -LocalPort 3000
```

**解决方法**: 停止占用端口的进程

### 问题3: 前端编译错误

**解决方法**: 使用开发模式，不需要构建：
```powershell
cd web-frontend
npm run dev
```

## 📝 下一步

编译完成后：

1. ✅ 运行 `.\本地启动.ps1` 启动所有服务
2. ✅ 访问 http://localhost:3000 查看界面
3. ✅ 检查连接状态和功能

---

**提示**: 如果编译时间较长，Gradle可能在下载Java 21和依赖，请耐心等待。

